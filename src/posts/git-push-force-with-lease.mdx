---
title: "Git force push의 안전장치 --force-with-lease"
desc: "Git에서 작업시 부득이하게 force push를 해야 할 때가 있습니다. 이때 --force-with-lease 옵션을 사용하면 조금 더 안전하게 force push를 할 수 있습니다."
thumbnail: /posts/git-push-force-with-lease/thumbnail.png
tags: ["git"]
createdAt: 2025-01-20T07:56:00.000Z
modifiedAt: 2025-01-20T07:56:00.000Z
---

## 들어가기 전에

Git 작업시 부득이하게 force 푸시를 해야 할 때가 있습니다.
force 푸시 옵션에는 2가지가 있습니다.

1. `--force`
2. `--force-with-lease`

`--force` 옵션은 강제로 원격 저장소의 커밋 히스토리를 덮어쓰는 작업입니다.

force 푸시가 어떤 위험이 있는지 알아보고, 안전하게 푸시하는 방법인 `--force-with-lease` 옵션에 대해서 알아보겠습니다.

## force 푸시의 위험성

설명하지 않아도 이미 경험상 알고 있는 분들이 많을 것 같습니다.

혼자서 작업하는 경우 `--force` 옵션을 사용해도 크게 문제가 없겠지만, 협업하는 경우 동료가 올린 작업 내역을 덮어쓰게 되는 문제가 있습니다.

### 사례 1.

마이크, 로지타 두 사람이 같은 브랜치에서 협업하는 상황을 가정해봅시다.
(마이크는 오랜세월 혼자서 작업하는데 익숙했고 force 푸시를 남발했습니다. 협업에 익숙하지 않습니다.)

1. 로지타는 앱의 버그를 수정해서 커밋을 푸시합니다.
2. 마이크도 앱의 버그를 수정해서 커밋을 푸시하지만 실패합니다.
3. 마이크는 왜 푸시가 실패했는지 모르지만 (알아보지도 않고) force 푸시합니다. (로지타가 작업한 내역을 덮어쓰게 됩니다.)

이후 앱을 배포했는데 버그가 발생했습니다.
로지타는 왜 수정한 버그가 또 발생했는지 이해가 안갔고, 찾는데 3시간이 걸렸습니다.

### 사례 2.

`사례 1` 같은 문제를 방지하기 위해서 로지타는 마이크에게 force 푸시하기 전에 꼭 협의하고 하자고 말합니다.

1. 로지타가 force 푸시 할 일이 생겼고 마이크한테 지금 force 푸시 할테니 작업 내역 올리지 말라고 말합니다. 마이크도 알겠다고 했습니다.
2. 하지만 마이크는 로지타가 force 푸시 하기 전에 자신의 작업 내역을 얼른 푸시합니다. (왜 그러지는 모름)
3. 로지타가 force 푸시 합니다. (마이크의 작업 내역을 덮어쓰게 됩니다.)

결국 또 버그가 발생합니다.

<Callout type="info">
  제가 로지타의 입장에서 겪은 경험담을 간략히만 적었습니다.
</Callout>

이렇게 협의하고 주의하더라도 사람은 실수할 수 있기 때문에 항상 주의해야 합니다.
force 푸시했을때 동료의 작업 내역을 덮어쓰게 되어서 사라진걸 바로 알게 된다면 그나마 괜찮지만, 바로 알지 못해서 나중에 알게 되는 경우도 있습니다.
